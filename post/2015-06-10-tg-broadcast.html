<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="박연오의 개인 웹 페이지. 컴퓨터 프로그래밍 등."><title>telegram-cli로 텔레그램 봇 만들기 (tg-broadcast) | 박연오</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">박연오</a><span class="subtitle">bakyeono.net</span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">home</a><a href="/archive" class="sidebar-nav-item">archive</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>telegram-cli로 텔레그램 봇 만들기 (tg-broadcast)</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2015-06-10</div><div class="post-tags"><a class="post-tag-link" href="/tag/bash/">bash</a>/<a class="post-tag-link" href="/tag/lua/">lua</a>/<a class="post-tag-link" href="/tag/telegram/">telegram</a>/<a class="post-tag-link" href="/tag/봇/">봇</a></div></div></div><article><div class="container post"><p>텔레그램 공식 봇 API가 나왔습니다. <a href="http://bakyeono.net/post/2015-08-24-using-telegram-bot-api.html">이를 이용해 로봇을 만드는 방법</a>도 있으니 참고하세요.</p>
<p><a href="https://github.com/bakyeono/tg-broadcast/blob/master/README.md" target="_blank" rel="external">See English Version</a></p>
<p><strong>tg-broadcast</strong>는 <a href="https://github.com/vysheng/tg" target="_blank" rel="external">telegram-cli(비공식)</a>에서 작동하는 텔레그램 방송 &amp; 자동 반응 로봇 스크립트입니다.</p>
<p>검색해 보시면 여러 가지 텔레그램 로봇 스크립트를 찾을 수 있으니 필요에 맞는 것을 잘 고르세요. 여러 사람에게 메시지를 방송하고 싶다면 이 스크립트를 추천합니다.</p>
<p>tg-broadcast은 telegram-cli 1.3.1 버전에서 테스트 되었습니다.</p>
<p>깃허브 저장소: <a href="https://github.com/bakyeono/tg-broadcast" target="_blank" rel="external">https://github.com/bakyeono/tg-broadcast</a></p>
<h2 id="기능"><a href="#기능" class="headerlink" title="기능"></a>기능</h2><h3 id="방송"><a href="#방송" class="headerlink" title="방송"></a>방송</h3><p>여러 구독자에게 메시지를 방송할 수 있습니다. 텔레그램 친구들은 당신에게 메시지를 하나 보내는 것만으로 구독을 신청하거나 철회할 수 있습니다.</p>
<h3 id="자동-반응"><a href="#자동-반응" class="headerlink" title="자동 반응"></a>자동 반응</h3><p><code>stdout</code>에 출력하는 프로그램을 연결해 자동으로 답장을 보낼 수 있습니다. 새로운 반응 규칙을 쉽게 추가할 수 있습니다.</p>
<h3 id="데이타베이스-사용-비사용"><a href="#데이타베이스-사용-비사용" class="headerlink" title="데이타베이스 사용 / 비사용"></a>데이타베이스 사용 / 비사용</h3><p>구독자 관리를 위해 SQLite3, MySQL, MariaDB을 지원합니다. 데이타베이스 없이 텍스트 파일로 관리하는 것도 지원합니다.</p>
<h2 id="설치"><a href="#설치" class="headerlink" title="설치"></a>설치</h2><h3 id="telegram-cli-설치-아직-하지-않은-경우"><a href="#telegram-cli-설치-아직-하지-않은-경우" class="headerlink" title="telegram-cli 설치 (아직 하지 않은 경우)"></a>telegram-cli 설치 (아직 하지 않은 경우)</h3><p>telegram-cli 소스코드 사본을 가져와 컴파일 합니다. <a href="https://github.com/vysheng/tg" target="_blank" rel="external">telegram-cli(비공식)</a> 페이지에 설명된 설치 과정을 따르세요.</p>
<pre><code>$ cd ~
$ git clone --recursive git@github.com:vysheng/tg.git
$ cd tg
$ ./configure
$ make
</code></pre><p>컴파일이 완료됐으면 컴파일 된 바이너리와 공개키 파일을 <code>~/telegram-cli</code> 경로에 복사합니다.</p>
<pre><code>$ mkdir ~/telegram-cli
$ cp bin/telegram-cli tg-server.pub ~/telegram-cli
</code></pre><p>이제 telegram-cli를 실행해봅니다. 처음 실행하면 인증을 거쳐야 합니다.</p>
<pre><code>$ cd ~/telegram-cli
$ ./telegram-cli
</code></pre><p>telegram-cli의 프롬프트에 <code>help</code>를 입력하면 사용가능한 명령어 목록을 볼 수 있습니다.</p>
<h3 id="tg-broadcast-설치"><a href="#tg-broadcast-설치" class="headerlink" title="tg-broadcast 설치"></a>tg-broadcast 설치</h3><p>이 저장소를 홈 디렉토리에 다운로드 하세요.</p>
<pre><code>$ cd ~
$ git clone git@github.com:bakyeono/tg-broadcast.git
$ cd tg-broadcast
</code></pre><p>SQLite3을 설치합니다. (SQLite3 사용을 추천합니다. SQLite3을 사용하고 싶지 않다면 . <code>config.lua</code> 파일을 보세요.)</p>
<pre><code>$ sudo apt-get install sqlite3
</code></pre><h2 id="실행"><a href="#실행" class="headerlink" title="실행"></a>실행</h2><p>이제 tg-broadcast 스크립트를 실행할 수 있습니다.</p>
<pre><code>$ ~/tg-broadcast/test   # REPL 모드로 실행
$ ~/tg-broadcast/start  # 데몬 모드로 실행
$ ~/tg-broadcast/stop   # telegram-cli 프로세스에 종료 신호를 보냅니다.
</code></pre><p>스크립트가 실행중일 때 자신에게 <code>help</code> 메시지를 보내면 아래와 같은 답장을 받을 겁니다.</p>
<pre><code>help        : This help
ip          : Server&apos;s IP address
time        : Server&apos;s time
calendar    : Calendar
weather CITY: Weather for CITY
subscribe   : Subscribe my news
unsubscribe : Unsubscribe my news
-------------------------
(admin only)
broadcast   : Force broadcast now
notify      : Send a message to subscribers
safequit    : Turn off robot
</code></pre><p><code>config.lua</code> 파일을 수정해서 방송할 내용을 수정하고 필요한 자동반응 명령을 추가하세요.</p>
</div><!-- comment system--><div class="container"><hr></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="mailto:bakyeono@gmail.com" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="https://github.com/bakyeono" target="_blank"><i class="fa fa-github"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2016 <a href="/" rel="nofollow">박연오</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});</script></body></html>